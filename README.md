## Экспорт данных из PostgreSQL в Excel

---

Этот скрипт позволяет легко экспортировать данные из указанной таблицы базы данных PostgreSQL в файл Excel. Он автоматически генерирует уникальные имена файлов и поддерживает пользовательские директории для сохранения.

### Возможности

* **Извлечение данных:** Подключается к базе данных PostgreSQL и извлекает все данные из указанной таблицы.
* **Экспорт в Excel:** Сохраняет полученные данные в файл формата `.xlsx`.
* **Автоматическое именование файлов:** Генерирует уникальное имя файла, такое как `table0.xlsx`, `table1.xlsx` и так далее, чтобы избежать перезаписи существующих файлов.
* **Настраиваемая директория:** Позволяет указать директорию для сохранения выходного файла.
* **Обработка кодировки:** Автоматически обрабатывает кодировку UTF-8 для корректного отображения данных в Excel.

### Установка

Прежде чем использовать скрипт, убедитесь, что у вас установлены все необходимые библиотеки:

```bash
pip install pandas openpyxl psycopg
```

### Использование

Запустите скрипт из командной строки:

```bash
python main.py
```

Скрипт запросит у вас следующую информацию:

* **Имя базы данных:** Имя базы данных PostgreSQL, к которой вы хотите подключиться.
* **Имя пользователя:** Имя пользователя для подключения к базе данных.
* **Пароль:** Пароль для указанного пользователя.
* **Имя таблицы:** Имя таблицы, данные из которой вы хотите экспортировать.

#### Аргументы командной строки

Вы также можете использовать следующие необязательные аргументы командной строки:

* `--filename`: Указывает желаемое имя выходного файла (например, `my_data.xlsx`). Если не указано, будет сгенерировано имя `tableX.xlsx`.
* `--directory`: Указывает путь к директории, куда будет сохранен файл. По умолчанию используется `C:\Users\eugen\OneDrive\Рабочий стол\sql_to_xlsx`.

Примеры:

Сохранить файл с именем по умолчанию в директорию по умолчанию:

```bash
python main.py
```

Сохранить файл с определенным именем в директорию по умолчанию:

```bash
python main.py --filename "users_data.xlsx"
```

Сохранить файл в определенную директорию:

```bash
python main.py --directory "D:\МоиДокументы\Экспорты"
```

Сохранить файл с определенным именем в определенную директорию:

```bash
python main.py --filename "products.xlsx" --directory "C:\Отчеты"
```

### Конфигурация

Вы можете изменить следующие константы в скрипте, если это необходимо:

* `HOST`: Хост базы данных PostgreSQL. По умолчанию: `localhost`.
* `PORT`: Порт базы данных PostgreSQL. По умолчанию: `5432`.
* `DEFAULT_DIRECTORY`: Директория по умолчанию для сохранения файлов, если она не указана в аргументах командной строки. По умолчанию: `C:\Users\eugen\OneDrive\Рабочий стол\sql_to_xlsx`.

---
